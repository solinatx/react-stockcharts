{"version":3,"sources":["../../../../src/lib/interactive/components/MouseLocationIndicator.js"],"names":["MouseLocationIndicator","props","renderSVG","bind","drawOnCanvas","handleMousePosChange","handleMouseDown","handleClick","xy","mutableState","moreProps","e","pos","xValue","yValue","x","y","xOrig","yOrig","returnXY","onMouseDown","onClick","xAccessor","plotData","mouseXY","currentItem","xScale","yScale","chartConfig","enabled","snap","shouldDisableSnap","snapTo","invert","mousXY","prevMouseXY","onMouseMove","ctx","r","stroke","strokeWidth","show","lineWidth","strokeStyle","moveTo","beginPath","arc","Math","PI","opacity","disablePan","handleContextMenu","propTypes","bool","isRequired","func","number","string","defaultProps"],"mappings":"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","file":"MouseLocationIndicator.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { getMouseCanvas } from \"../../GenericComponent\";\n\nimport { isDefined, getClosestValue, noop, shallowEqual, functor } from \"../../utils\";\nimport { getXValue } from \"../../utils/ChartDataUtil\";\n\nclass MouseLocationIndicator extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\n\t\tthis.handleMousePosChange = this.handleMousePosChange.bind(this);\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.xy = this.xy.bind(this);\n\n\t\tthis.mutableState = {};\n\t}\n\thandleMouseDown(moreProps, e) {\n\t\tconst pos = this.xy(moreProps, e);\n\t\tif (isDefined(pos)) {\n\t\t\tconst { xValue, yValue, x, y, xOrig, yOrig } = pos;\n\t\t\tthis.mutableState = { x, y };\n\t\t\tif (!this.props.returnXY) {\n\t\t\t\tthis.props.onMouseDown([xValue, yValue], moreProps, e);\n\t\t\t} else {\n\n\t\t\t\tthis.props.onMouseDown([xValue, yValue], moreProps, e, [xOrig, yOrig]);\n\t\t  }\n\t  }\n\t}\n\thandleClick(moreProps, e) {\n\t\tconst pos = this.xy(moreProps, e);\n\t\tif (isDefined(pos)) {\n\t\t\tconst { xValue, yValue, x, y, xOrig, yOrig } = pos;\n\t\t\tthis.mutableState = { x, y };\n\t\t\tif (!this.props.returnXY) {\n\t\t\t\tthis.props.onClick([xValue, yValue], moreProps, e);\n\t\t\t} else {\n\t\t\t\tthis.props.onClick([xValue, yValue], moreProps, e, [xOrig, yOrig]);\n\t\t\t}\n\t\t}\n\t }\n\txy(moreProps, e) {\n\t\tconst { xAccessor, plotData } = moreProps;\n\t\tconst { mouseXY, currentItem, xScale, chartConfig: { yScale } } = moreProps;\n\t\tconst { enabled, snap, shouldDisableSnap, snapTo } = this.props;\n\n\t\tif (enabled && isDefined(currentItem) && isDefined(e)) {\n\t\t\tconst xValue =  snap && !shouldDisableSnap(e)\n\t\t\t\t? xAccessor(currentItem)\n\t\t\t\t: getXValue(xScale, xAccessor, mouseXY, plotData);\n\t\t\tconst yValue = snap && !shouldDisableSnap(e)\n\t\t\t\t? getClosestValue(snapTo(currentItem), yScale.invert(mouseXY[1]))\n\t\t\t\t: yScale.invert(mouseXY[1]);\n\n\t\t\tconst x = xScale(xValue);\n\t\t\tconst y = yScale(yValue);\n\n\t\t\treturn { xValue, yValue, x, y, xOrig: mouseXY[0], yOrig: mouseXY[1] };\n\t\t}\n\t}\n\thandleMousePosChange(moreProps, e) {\n\t\tif (!shallowEqual(moreProps.mousXY, moreProps.prevMouseXY)) {\n\t\t\tconst pos = this.xy(moreProps, e);\n\t\t\tif (isDefined(pos)) {\n\t\t\t\tconst { xValue, yValue, x, y, xOrig, yOrig } = pos;\n\t\t\t\tthis.mutableState = { x, y };\n\t\t\t\tif (!this.props.returnXY) {\n\t\t\t\t  this.props.onMouseMove([xValue, yValue], e);\n\t\t\t\t} else {\n\t\t\t\t  this.props.onMouseMove([xValue, yValue], e, [xOrig, yOrig]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { enabled, r, stroke, strokeWidth } = this.props;\n\t\tconst { x, y } = this.mutableState;\n\t\tconst { show } = moreProps;\n\t\t// console.log(show)\n\t\tif (enabled && show && isDefined(x)) {\n\t\t\tctx.lineWidth = strokeWidth;\n\t\t\tctx.strokeStyle = stroke;\n\t\t\tctx.moveTo(x, y);\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(x, y, r, 0, 2 * Math.PI, false);\n\t\t\tctx.stroke();\n\t\t\t// ctx.fill();\n\t\t}\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { enabled, r, stroke, strokeWidth, opacity } = this.props;\n\t\tconst { x, y } = this.mutableState;\n\t\tconst { show } = moreProps;\n\n\t\t// console.log(\"HERE\")\n\t\t// console.log(stroke, strokeWidth, opacity)\n\n\t\treturn enabled && show && isDefined(x)\n\t\t\t? <circle\n\t\t\t\tcx={x}\n\t\t\t\tcy={y}\n\t\t\t\tr={r}\n\t\t\t\tstroke={stroke}\n\t\t\t\topacity={opacity}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstrokeWidth={strokeWidth} />\n\t\t\t: null;\n\n\t}\n\trender() {\n\t\tconst { enabled, disablePan } = this.props;\n\t\treturn <GenericChartComponent\n\t\t\tonMouseDown={this.handleMouseDown}\n\t\t\tonClick={this.handleClick}\n\t\t\tonContextMenu={this.handleContextMenu}\n\t\t\tonMouseMove={this.handleMousePosChange}\n\t\t\tonPan={this.handleMousePosChange}\n\n\t\t\tdisablePan={enabled && disablePan}\n\n\t\t\tsvgDraw={this.renderSVG}\n\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getMouseCanvas}\n\n\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\n\t\t/>;\n\t}\n}\n\nMouseLocationIndicator.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\tsnap: PropTypes.bool.isRequired,\n\tshouldDisableSnap: PropTypes.func.isRequired,\n\tsnapTo: PropTypes.func,\n\n\tonMouseMove: PropTypes.func.isRequired,\n\tonMouseDown: PropTypes.func.isRequired,\n\tonClick: PropTypes.func.isRequired,\n\tr: PropTypes.number.isRequired,\n\tstroke: PropTypes.string.isRequired,\n\tstrokeWidth: PropTypes.number.isRequired,\n\topacity: PropTypes.number.isRequired,\n\tdisablePan: PropTypes.bool.isRequired,\n\n\treturnXY: PropTypes.bool,\n};\n\nMouseLocationIndicator.defaultProps = {\n\tonMouseMove: noop,\n\tonMouseDown: noop,\n\tonClick: noop,\n\tshouldDisableSnap: functor(false),\n\tstroke: \"#000000\",\n\tstrokeWidth: 1,\n\topacity: 1,\n\tdisablePan: true,\n\treturnXY: false,\n};\n\nexport default MouseLocationIndicator;\n"]}